<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>SupplyChain</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

<!-- the leaflet CSS and JS library -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin="">
	<!-- Make sure you put this AFTER leaflet's CSS -->
	<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>
	<!-- Add JQuery to get local GeoJson file -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <style>

        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

	


<div id='map'></div>

	<!-- Add jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>

<script>

	//add AJAX request for data
		var supplydata = $.ajax({
			url: ("scripts/supplyidfinal.geojson"),
			dataType: "json",
			success: console.log("supply chain data loaded."),
			error: function (xhr) {
				alert(xhr.statusText)
			}
		})

		$.when(supplydata).done(function(){

		var map = L.map('map')
			.setView([11.97, 38.66])

		var basemap = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

		//add requested external GeoJSON
		var kysupplydata = L.geoJSON(supplydata.responseJSON).addTo(map);
	});

</script>

<!--
//Basemap from http://leaflet-extras.github.io/leaflet-providers/preview/
			var OpenStreetMap_BlackAndWhite = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
		maxZoom: 18,
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
			});
		//make the map
		var map = new L.Map("map", {
			center: new L.LatLng(11.97, 38.66),
			zoom: 2
		});

		map.addLayer(OpenStreetMap_BlackAndWhite)




$.getJSON("scripts/supplyidfinal.geojson", function(data){
	var bcircle= L.icon({
		iconUrl: "MyImages/blackcircle.png", //<div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/"                 title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/"                 title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>
		iconSize: [16, 16]
	});
	L.geoJson(data, {
		pointToLayer: function(feature,LatLng){
			var marker = L.marker(latlng, {icon: bcircle});
			marker.bindPopup("<p>manu_site: "+feature.properties.manu_site+"</p>");
			return marker;
		}
	}).addTo(map);
});
-->


<!--
//add zoom and rotation controls to map
	map.scrollZoom.disable();
	map.addControl(new mapboxgl.NavigationControl());
//on map load, display data
map.on('load', function(){
	//adding source layer for earthquakes
	map.addSource('supply', {
		"type": "geojson",
		"data": "supplychain.geojson"
	});
	//add earthquake points to map
	//thanks to https://www.mapbox.com/mapbox-gl-js/example/popup-on-click/ & https://mseto-uw.github.io/mapbox_example.html
	map.addLayer({
		"id": "manu",
		"type": "circle",
		"source": "supply",
		});
	});
</script>

-->
</body>
</html>